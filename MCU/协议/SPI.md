### SPI
	SPI协议是由摩托罗拉公司提出的通讯协议（Serial Peripheral Interface），即串行外围设备接口，是一种高速全双工的通信总线。它被广泛地使用在ADC、LCD等设备与MCU间，要求通讯速率较高的场合；

#### 物理层：
	SPI通讯使用3条总线及片选线，3条总线分别为SCK、MOSI、MISO，片选线为SS；
 
- SS（Slave Select）：从设备选择信号线，简称片选信号线，也称为NSS、CS、有多少个从机就有多少根片选线，低电平有效；
- SCK（Serial Clock）：时钟信号线，用于通讯数据同步，由通讯主机产生，通讯速率受限于低速设备；
- MOSI（Master Output，Slave Input）：主设备输出/从设备输入引脚，主机的数据从这条信号线输出，从机由这条信号线读入主机发送的数据；
- MISO（Master Input，Slave Output）：主设备输入/从设备输出引脚，主机从这条信号线读入数据，从机的数据由这条信号线输出到主机。

#### 协议层：
	NSS、SCK、MOSI信号都由主机控制产生， 而MSIO的信号由从机产生，主机通过该信号线读取从机的数据，MOSI与MISO的信号只在NSS为低电平的时候才有效，在SCK的每个时钟周期MOSI和MISO传输一位数据；

- 时钟极性CPOL：
	时钟极性CPOL是指SPI通讯设备处于空闲状态时，SCK信号线的电平信号（即SPI通讯开始前、NSS线为高电平时SCK的状态）。CPOL=0时，SCK在空闲状态时为低电平，CPOL=1时，则相反；
- 时钟相位CPHA：
	时钟相位CPHA是指数据的采样时刻，当CPHA=0时，MOSI或MISO数据线的信号将在SCK时钟线的“奇数边沿”被采样。当CPHA=1时，数据线在SCK的“偶数边沿”采样。

起始信号及停止信号：
	NSS信号线由高变低是SPI通讯的起始信号，NSS信号线由低变高是SPI通讯的停止信号，表示本次通讯结束，从机的选中状态被取消；

数据传输：
	SPI使用MOSI及MISO信号线来传输数据，使用SCK信号线进行数据同步。MOSI及MISO数据线在SCK的每个时钟周期传输一位数据，且数据输入输出是同时进行的。数据传输时可以选择MSB先行或者LSB先行，需保证两个SPI通讯设备之间 使用相同的规定，一般都采用MSB先行模式；
	数据有效性由CPHA决定；
	SPI每次数据传输可以以8位或者16位为单位，每次传输的单位数不受限制；

SPI通讯的四种模式：

STM32的SPI外设：
	STM32的SPI外设可以用作通讯的主机及从机，支持最高的SCK时钟频率为$f_{pclk}/2$，完全支持SPI协议的四种模式，数据帧长度可以设置为8位或16位，可以设置数据MSB先行或者LSB先行。还支持双线全双工、双线单向以及单线模式。
	其中双线单向模式可以同时使用MOSI及MISO数据线向一个方向传输数据，可以加快一倍的传输速度，而单线模式可以减少硬件接线；
