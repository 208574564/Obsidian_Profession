#### 1.物理层
##### 特点：
1. 支持多个设备从机；
2. 只使用两条总线线路：双向串行数据线(SDA)、串行时钟线(SCL)；
3. 每个设备从机都有一个独立的地址；
4. 总线通过上拉电阻接到电源，当设备空闲时，输出高阻态，全部设备空闲时，总线高电平；
5. 仲裁方式决定哪个设备使用总线；
6. 三种传输模式：标准模式(100KBit/s）、快速模式(400KBit/s)、高速模式(3.4MBit/s);
7. 连接到相同总线的IC数量收到总线最大电容400pf限制；
8. I2C的引脚必须使用开漏输出模式；
9. 数据收发从高位开始，例如写的时候就先将字节中的MSB转移到移位寄存器发送；
10. 低电平表示应答、高电平表示非应答；
11. 低电平表示方向写、高电平表示方向读；

#### 2.协议层：
	数据包的大小为一个字节。
##### 协议内容：
- 读：
>1.主机广播发送一个起始位；
>2.主机广播一个从站地址，并指定读（1）模式；
>3.对应地址上的从机返回一个应答信号；
>4.从机写回数据；
>5.主机向从机发回一个响应位；
>6.从机继续发送直到主机发送一个非响应位；
- 写
>1.主机广播发送一个起始位；
>2.主机广播一个从站地址，并指定写（0）模式；
>3.对应地址上的从机返回一个应答信号；
>4.主机往从机写数据
>5.从机向主机发回一个响应位；
>6.主机继续发送直到从机发送一个非响应位；
- 复合读写
> 1.第一次传输，主机发送起始位；
> 2.主机通过广播从站地址定位到从站，并指定读写；
> 3.指定从站设备内部的寄存器或存储器地址；
> 4.第二次传输，主机发送起始位，通过广播地址定位到从站，并指定读写；
> 5.读写直到主机或从站返回非应答；

##### 信号检测：
- 起始位和停止位：CLK为高电平时检测SDA电平边缘；
- 数据位：CLK为高电平时检测SDA电平的高低；

##### 协议约定：
- 从站地址为7位或10位;
- 数据方向为：写(0)、读(1);
- 响应：应答(ACK)、非应答(NACK);

#### 3.实现：
	软件实现I2C协议的关键在于：
	1. GPIO被设置为输出模式时，能否在寄存器读取到外部引起电平的极性。
	2. 需要释放控制权（等待响应位、读写结束）时，需要将SDA置位高电平以输出高阻态，此时引脚电平 由外部决定。

##### 寄存器
1.CCR
> SCL信号线与基础时钟TPCLK的比值。


编程顺序：《HAL库》
1. 配置通讯使用的目标引脚为开漏模式；
2. 使能I2C外设的时钟；
3. 配置I2C外设的模式、地址、速率等参数并使能I2C外设；
4. 编写基本I2C按字节收发的函数；
5. 编写读写EEPROM存储内容的函数；


